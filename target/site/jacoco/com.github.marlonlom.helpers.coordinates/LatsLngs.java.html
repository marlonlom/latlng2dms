<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="es"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>LatsLngs.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">latlng2dms</a> &gt; <a href="index.source.html" class="el_package">com.github.marlonlom.helpers.coordinates</a> &gt; <span class="el_source">LatsLngs.java</span></div><h1>LatsLngs.java</h1><pre class="source lang-java linenums">package com.github.marlonlom.helpers.coordinates;

import java.util.Arrays;
import java.util.List;
import java.util.ResourceBundle;

/**
 * The fluent builder utility Class LatsLngs.
 *
 * @author Mjlopezm
 *
 */
<span class="nc" id="L13">public final class LatsLngs {</span>

    /**
     * The Class Builder.
     *
     * @author Mjlopezm
     */
    public static final class Builder implements IWithValues, IWithSingleValue {

        /**
         * The coordinates.
         */
        private List&lt;Double&gt; coordinates;

        /**
         * The single value.
         */
        private Double singleValue;

        /**
         * The single value as latitude.
         */
        private int singleValueAs;

        /**
         * The single value enabled.
         */
        private boolean singleValueEnabled;

        /**
         * Instantiates a new builder.
         */
        private Builder() {
<span class="fc" id="L46">            super();</span>
<span class="fc" id="L47">        }</span>

        /*
         * (non-Javadoc)
         * 
         * @see com.github.marlonlom.helpers.coordinates.LatsLngs.IWithSingleValue# asLatitude()
         */
        @Override
        public IWithValues asLatitude() {
<span class="fc" id="L56">            this.singleValueAs = Constants.LATITUDE_INDEX;</span>
<span class="fc" id="L57">            return this;</span>
        }

        /*
         * (non-Javadoc)
         * 
         * @see com.github.marlonlom.helpers.coordinates.LatsLngs.IWithSingleValue# asLongitude()
         */
        @Override
        public IWithValues asLongitude() {
<span class="fc" id="L67">            this.singleValueAs = Constants.LONGITUDE_INDEX;</span>
<span class="fc" id="L68">            return this;</span>
        }

        /*
         * (non-Javadoc)
         * 
         * @see com.github.marlonlom.helpers.coordinates.LatsLngs.IWithValues# toDms()
         */
        @Override
        public String toDms() throws Exception {
<span class="fc" id="L78">            final StringBuilder builder = new StringBuilder();</span>
<span class="fc bfc" id="L79" title="All 2 branches covered.">            if (this.singleValueEnabled) {</span>
<span class="fc" id="L80">                builder.append(LatsLngs.processSingleValue(this.singleValue, this.singleValueAs));</span>
            } else {
<span class="fc" id="L82">                builder.append(processCoordinates(this.coordinates));</span>
            }
<span class="fc" id="L84">            return builder.toString().trim();</span>
        }

        /**
         * Prepare conversion using single coordinate value.
         *
         * @param value coordinate value
         * @return the builder implementation with single value
         */
        private IWithSingleValue with(Double value) {
<span class="fc" id="L94">            this.singleValue = value;</span>
<span class="fc" id="L95">            this.singleValueEnabled = true;</span>
<span class="fc" id="L96">            return this;</span>
        }

        /**
         * Prepare conversion using coordinates.
         *
         * @param coordinates coordinates values (longitude, latitude)
         * @return the builder implementation with coordinates
         */
        private IWithValues with(final Double[] coordinates) {
<span class="fc" id="L106">            this.coordinates = Arrays.asList(coordinates);</span>
<span class="fc" id="L107">            this.singleValueEnabled = false;</span>
<span class="fc" id="L108">            return this;</span>
        }

    }

    /**
     * The Class Exception.
     *
     * @author Mjlopezm
     */
    public static final class Exception extends java.lang.Exception {

        /**
         * The Constant serialVersionUID.
         */
        private static final long serialVersionUID = 549354576840147795L;

        /**
         * The coordinates count.
         */
        private final int coordinatesCount;

        /**
         * Instantiates a new exception.
         *
         * @param message the message
         */
        public Exception(final String message) {
<span class="fc" id="L136">            super(message);</span>
<span class="fc" id="L137">            this.coordinatesCount = Constants.ONE_NEGATIVE;</span>
<span class="fc" id="L138">        }</span>

        /**
         * Instantiates a new exception.
         *
         * @param message the message
         * @param coordinatesCount the coordinates count
         */
        public Exception(final String message, final int coordinatesCount) {
<span class="fc" id="L147">            super(message);</span>
<span class="fc" id="L148">            this.coordinatesCount = coordinatesCount;</span>
<span class="fc" id="L149">        }</span>

        /**
         * Gets the coordinates count.
         *
         * @return the coordinates count
         */
        public int getCoordinatesCount() {
<span class="fc" id="L157">            return coordinatesCount;</span>
        }

    }

    /**
     * The Interface IWithSingleValue.
     */
    public interface IWithSingleValue {

        /**
         * As latitude.
         *
         * @return the i with values
         */
        IWithValues asLatitude();

        /**
         * As longitude.
         *
         * @return the i with values
         */
        IWithValues asLongitude();

    }

    /**
     * The Interface IWithValues.
     */
<span class="nc" id="L186">    public interface IWithValues {</span>

        /**
         * To dms.
         *
         * @return dms text
         * @throws Exception the exception
         */
        String toDms() throws Exception;
    }

    /**
     * The Constant MESSAGES.
     */
<span class="fc" id="L200">    private static final ResourceBundle MESSAGES</span>
<span class="fc" id="L201">            = ResourceBundle.getBundle(&quot;com.github.marlonlom.helpers.coordinates.messages&quot;);</span>

    /**
     * Gets the latitude direction.
     *
     * @param latitude a latitude coordinate value
     * @return the latitude direction
     * @throws Exception if an error happen
     */
    private static String getLatitudeDirection(double latitude) throws Exception {
<span class="fc bfc" id="L211" title="All 2 branches covered.">        if (Math.abs(latitude) &gt; 90d) {</span>
<span class="fc" id="L212">            throw new LatsLngs.Exception(MESSAGES.getString(&quot;errors.latitude.greater&quot;));</span>
        }
<span class="fc bfc" id="L214" title="All 4 branches covered.">        return latitude &gt; Constants.ZERO ? Constants.DIRECTIONS[Constants.ZERO]</span>
                : latitude &lt; Constants.ZERO ? Constants.DIRECTIONS[Constants.ONE] : Constants.EMPTY;
    }

    /**
     * Gets the longitude direction.
     *
     * @param longitude a longitude coordinate value
     * @return the longitude direction
     * @throws Exception if an error happen
     */
    private static String getLongitudeDirection(double longitude) throws Exception {
<span class="fc bfc" id="L226" title="All 2 branches covered.">        if (Math.abs(longitude) &gt; 180d) {</span>
<span class="fc" id="L227">            throw new LatsLngs.Exception(MESSAGES.getString(&quot;errors.longitude.greater&quot;));</span>
        }
<span class="fc bfc" id="L229" title="All 4 branches covered.">        return longitude &gt; Constants.ZERO ? Constants.DIRECTIONS[Constants.TWO]</span>
                : longitude &lt; Constants.ZERO ? Constants.DIRECTIONS[Constants.THREE] : Constants.EMPTY;
    }

    /**
     * Process coordinates as decimal values, in terms of latitude and longitude
     * , respectively.
     *
     * @param coordinates coordinates data (longitude at index 0,laitude at
     * index 1)
     * @return coordinates represented as DMS format
     * @throws Exception if an error happen
     */
    private static String processCoordinates(final List&lt;Double&gt; coordinates)
            throws LatsLngs.Exception {
<span class="fc" id="L244">        StringBuilder dmsResult = new StringBuilder(Constants.EMPTY);</span>
<span class="fc bfc" id="L245" title="All 2 branches covered.">        if (coordinates.size() == Constants.TWO) {</span>
<span class="fc" id="L246">            final String dmsFormat = &quot;%s %s&quot;;</span>

<span class="fc" id="L248">            final Double latitudeCoordinate = coordinates.get(Constants.LATITUDE_INDEX);</span>
<span class="fc" id="L249">            final String latitudeDms = DecimalToDms.format(latitudeCoordinate);</span>
<span class="fc" id="L250">            final String latitudeDirection = getLatitudeDirection(latitudeCoordinate);</span>
<span class="fc" id="L251">            dmsResult.append(String.format(dmsFormat, latitudeDms, latitudeDirection).trim());</span>

<span class="fc" id="L253">            dmsResult.append(&quot;,&quot;).append(Constants.SPACE);</span>

<span class="fc" id="L255">            final Double longitudeCooordinate = coordinates.get(Constants.LONGITUDE_INDEX);</span>
<span class="fc" id="L256">            final String longitudeDms = DecimalToDms.format(longitudeCooordinate);</span>
<span class="fc" id="L257">            final String longitudeDirection = getLongitudeDirection(longitudeCooordinate);</span>
<span class="fc" id="L258">            dmsResult.append(String.format(dmsFormat, longitudeDms, longitudeDirection).trim());</span>
<span class="fc" id="L259">        } else {</span>
<span class="fc" id="L260">            throw new LatsLngs.Exception(MESSAGES.getString(&quot;errors.coordinates.count.invalid&quot;),</span>
<span class="fc" id="L261">                    coordinates.size());</span>
        }
<span class="fc" id="L263">        return dmsResult.toString();</span>
    }

    /**
     * Process single coordinate value.
     *
     * @param coordinate the single value
     * @param isEnabled the single value enabled
     * @param asLatitude the single value as latitude
     * @return the string
     * @throws Exception if an error happen
     */
    private static String processSingleValue(final Double coordinate,
            final Integer conversionMode) throws Exception {
<span class="fc" id="L277">        final StringBuilder dmsResult = new StringBuilder(Constants.EMPTY);</span>
<span class="fc" id="L278">        dmsResult.append(DecimalToDms.format(coordinate)).append(Constants.SPACE);</span>
<span class="fc bfc" id="L279" title="All 2 branches covered.">        String dmsDirection = conversionMode.equals(Constants.LATITUDE_INDEX)</span>
<span class="fc" id="L280">                ? getLatitudeDirection(coordinate) : Constants.EMPTY;</span>
<span class="fc bfc" id="L281" title="All 2 branches covered.">        dmsDirection = (dmsDirection.equalsIgnoreCase(Constants.EMPTY)</span>
<span class="fc bfc" id="L282" title="All 2 branches covered.">                &amp;&amp; conversionMode.equals(Constants.LONGITUDE_INDEX))</span>
<span class="fc" id="L283">                        ? getLongitudeDirection(coordinate) : dmsDirection;</span>
<span class="fc" id="L284">        dmsResult.append(dmsDirection).trimToSize();</span>
<span class="fc" id="L285">        return dmsResult.toString();</span>
    }

    /**
     * With single coordinate value.
     *
     * @param value coordinate value
     * @return builder implementation
     */
    public static Builder with(final Double value) {
<span class="fc" id="L295">        return (Builder) new Builder().with(value);</span>
    }

    /**
     * With cooordinates.
     *
     * @param coordinates coordinates (longitude, latitude)
     * @return builder implementation
     */
    public static Builder with(final Double[] coordinates) {
<span class="fc" id="L305">        return (Builder) new Builder().with(coordinates);</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.7.9.201702052155</span></div></body></html>